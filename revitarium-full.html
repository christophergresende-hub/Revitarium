<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Revitarium ‚Äî Full App</title>

  <!-- Chart.js CDN (required for charts) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <style>
    /* ===== Theme & Base ===== */
    :root{
      --bg:#04141a; --card:#071822; --accent:#00f0ff; --accent-2:#00a6ff;
      --muted:#98a6ad; --text:#dbeef6; --glass-border: rgba(0,180,255,0.08);
      --radius:18px; --shadow: 0 14px 40px rgba(0,0,0,0.6);
    }
    html,body{height:100%; margin:0; font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial; background:
      radial-gradient(ellipse at 20% 10%, rgba(0,50,70,0.14), transparent 10%),
      linear-gradient(180deg, #042028 0%, #021217 80%); color:var(--text); -webkit-font-smoothing:antialiased;}
    a{color:inherit}

    /* ===== Layout ===== */
    .wrap { min-height:100vh; display:flex; align-items:center; justify-content:center; padding:24px; box-sizing:border-box; }
    /* Card container used both for login and dashboard inner panels */
    .card {
      width:100%; max-width:760px; background: linear-gradient(180deg, rgba(0,8,12,0.45), rgba(0,0,0,0.44));
      border-radius:20px; padding:28px; box-shadow: var(--shadow); border:1px solid var(--glass-border);
      box-sizing:border-box; position:relative; overflow:hidden;
    }

    /* ===== LOGIN ===== */
    #loginView { max-width:420px; }
    .brand { text-align:center; margin-bottom:18px; font-size:40px; color:var(--accent); font-weight:800; text-shadow: 0 6px 20px rgba(0,160,255,0.06);}
    label { display:block; margin:12px 0 6px; color:var(--muted); font-size:14px; }
    input[type="text"], input[type="password"] {
      width:100%; padding:14px; border-radius:12px; border:1px solid rgba(255,255,255,0.04);
      background: rgba(255,255,255,0.02); color:var(--text); box-sizing:border-box; font-size:15px;
    }
    button.primary {
      margin-top:18px; width:100%; padding:14px; border-radius:18px; border:none; cursor:pointer;
      background: linear-gradient(90deg,var(--accent),var(--accent-2)); color:#021217; font-weight:800; font-size:18px;
      box-shadow: 0 10px 30px rgba(0,160,255,0.12);
    }
    .hint { font-size:13px; color:var(--muted); text-align:center; margin-top:12px; }

    /* ===== DASHBOARD LAYOUT ===== */
    #dashboardView { display:none; }
    .app-grid { display:grid; grid-template-columns: 72px 1fr; gap:20px; align-items:start; }
    /* sidebar */
    .sidebar { background: linear-gradient(180deg, rgba(6,20,22,0.8), rgba(4,12,14,0.85)); border-radius:14px; padding:14px; display:flex; flex-direction:column; gap:12px; align-items:center; }
    .icon-btn { width:44px;height:44px;border-radius:12px;display:flex;align-items:center;justify-content:center;color:rgba(255,255,255,0.85); background:transparent; border:1px solid rgba(255,255,255,0.02); cursor:pointer; }
    .icon-btn.active, .icon-btn:hover { background: rgba(0,224,255,0.06); color:var(--accent-2); transform:translateX(4px); }
    /* main */
    .main-area { padding:8px 0; }
    .topbar { display:flex; justify-content:space-between; align-items:center; gap:12px; margin-bottom:18px; }
    .page-title { font-size:34px; font-weight:800; color:var(--text); }
    .controls { display:flex; align-items:center; gap:12px; }
    .export { padding:8px 12px; border-radius:999px; background:rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.04); color:var(--text); cursor:pointer; }
    .switch { display:flex; gap:8px; align-items:center; color:var(--muted); }

    /* grid cards */
    .grid { display:grid; grid-template-columns: 1fr; gap:16px; }
    @media(min-width:980px){ .grid { grid-template-columns: 1fr 380px; } }
    .card h3 { margin:0 0 10px 0; color:var(--accent); font-size:20px; }
    .chart-card { height:260px; padding:18px; box-sizing:border-box; }
    canvas { width:100% !important; height:100% !important; display:block; }

    .list { list-style:none; padding:0; margin:0; display:flex; flex-direction:column; gap:8px; }
    .list li { background: linear-gradient(180deg, rgba(0,0,0,0.10), rgba(255,255,255,0.01)); padding:10px; border-radius:10px; border: 1px solid rgba(255,255,255,0.02); color:var(--text); }

    .kpi { display:flex; gap:12px; }
    .mini { flex:1; padding:12px; border-radius:12px; background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.07)); border:1px solid rgba(255,255,255,0.02); text-align:center; }
    .mini h4 { margin:0; color:var(--accent); font-size:18px; }
    .mini p { margin:6px 0 0; color:var(--muted); font-size:13px; }

    .btn-small { padding:8px 10px; border-radius:12px; border:none; cursor:pointer; background:linear-gradient(90deg,var(--accent),var(--accent-2)); color:#021217; font-weight:700; }

    /* small screen adjustments */
    @media(max-width:679px){
      .app-grid{ grid-template-columns: 1fr; }
      .sidebar{ flex-direction:row; width:100%; justify-content:space-around; border-radius:12px; padding:8px; }
    }

    /* utility */
    .hidden{ display:none !important; }
    .mt12{ margin-top:12px; }
  </style>
</head>
<body>
  <div class="wrap">

    <!-- LOGIN view -->
    <div id="loginView" class="card" aria-hidden="false">
      <div class="brand">Revitarium</div>
      <form id="loginForm" autocomplete="off" aria-label="Formul√°rio de login">
        <label for="user">Usu√°rio</label>
        <input id="user" type="text" placeholder="Digite seu usu√°rio" />
        <label for="pass">Senha</label>
        <input id="pass" type="password" placeholder="Digite sua senha" />
        <button class="primary" type="submit">Entrar</button>
        <div class="hint">Use <strong>admin / 123</strong> para testar</div>
      </form>
    </div>

    <!-- DASHBOARD view (hidden until login) -->
    <div id="dashboardView" class="card hidden" aria-hidden="true" style="width:100%;max-width:1200px;">
      <div class="app-grid">
        <!-- SIDEBAR -->
        <aside class="sidebar" role="navigation" aria-label="Barra lateral">
          <div style="font-weight:800;color:var(--accent);font-size:20px;">R</div>
          <button class="icon-btn active" data-nav="dashboard" title="Dashboard">üè†</button>
          <button class="icon-btn" data-nav="reports" title="Relat√≥rios">üìà</button>
          <button class="icon-btn" data-nav="users" title="Usu√°rios">üë•</button>
          <button class="icon-btn" data-nav="settings" title="Configura√ß√µes">‚öôÔ∏è</button>
          <div style="flex:1"></div>
          <button id="btnLogout" class="icon-btn" title="Sair">‚§¥Ô∏è</button>
        </aside>

        <!-- MAIN AREA -->
        <main class="main-area">
          <div class="topbar">
            <div style="display:flex;align-items:center;gap:18px;">
              <div class="page-title">Dashboard</div>
              <div style="color:var(--muted)">Revitarium</div>
            </div>

            <div class="controls">
              <button id="exportCsv" class="export">Exportar CSV</button>
              <label class="switch"><input id="autoRefresh" type="checkbox" /> <span style="margin-left:6px;color:var(--muted)">Auto-refresh</span></label>
            </div>
          </div>

          <div class="grid">
            <!-- left column -->
            <div>
              <section class="card chart-card">
                <h3>Visitas (√∫ltimos 7 dias)</h3>
                <canvas id="visitsChart"></canvas>
              </section>

              <section class="card chart-card mt12">
                <h3>Convers√µes</h3>
                <canvas id="conversionsChart"></canvas>
              </section>

              <section class="card mt12">
                <h3>Resumo</h3>
                <ul class="list mt12">
                  <li>Total de usu√°rios: <strong id="statUsers">-</strong></li>
                  <li>Total de sess√µes: <strong id="statSessions">-</strong></li>
                  <li>Taxa convers√£o: <strong id="statConversion">-</strong></li>
                </ul>
              </section>
            </div>

            <!-- right column -->
            <aside>
              <section class="card">
                <h3>√öltimas a√ß√µes</h3>
                <div style="display:flex;gap:8px;margin-top:8px;">
                  <button id="addActionBtn" class="btn-small">Adicionar a√ß√£o</button>
                  <button id="clearActionsBtn" class="btn-small" style="background:#22333b;color:var(--text)">Limpar</button>
                </div>
                <ul id="recentActions" class="list mt12"></ul>
              </section>

              <section class="card mt12">
                <h3>Atividades pendentes</h3>
                <form id="todoForm" style="display:flex;gap:8px;margin-top:8px">
                  <input id="todoInput" type="text" placeholder="Nova tarefa..." />
                  <button class="btn-small" type="submit">Adicionar</button>
                </form>
                <ul id="todoList" class="list mt12"></ul>
              </section>

              <section class="card mt12">
                <h3>Usu√°rios</h3>
                <form id="userForm" style="display:flex;flex-direction:column;gap:8px;margin-top:8px">
                  <input id="userName" placeholder="Nome" />
                  <input id="userRole" placeholder="Cargo/Role" />
                  <div style="display:flex;gap:8px;"><button class="btn-small" type="submit">Adicionar</button></div>
                </form>
                <ul id="usersList" class="list mt12"></ul>
              </section>
            </aside>
          </div>
        </main>
      </div>
    </div>

  </div>

  <!-- ===== App JS (embedded single-file) ===== -->
  <script>
  (function(){
    // Elements
    const loginView = document.getElementById('loginView');
    const dashboardView = document.getElementById('dashboardView');
    const loginForm = document.getElementById('loginForm');
    const userInput = document.getElementById('user');
    const passInput = document.getElementById('pass');
    const btnLogout = document.getElementById('btnLogout');

    // Dashboard elements
    const visitsCtxEl = document.getElementById('visitsChart');
    const convCtxEl = document.getElementById('conversionsChart');
    const recentActions = document.getElementById('recentActions');
    const todoForm = document.getElementById('todoForm');
    const todoInput = document.getElementById('todoInput');
    const todoList = document.getElementById('todoList');
    const userForm = document.getElementById('userForm');
    const usersList = document.getElementById('usersList');
    const exportBtn = document.getElementById('exportCsv');
    const addActionBtn = document.getElementById('addActionBtn');
    const clearActionsBtn = document.getElementById('clearActionsBtn');
    const autoRefresh = document.getElementById('autoRefresh');
    const statUsers = document.getElementById('statUsers');
    const statSessions = document.getElementById('statSessions');
    const statConversion = document.getElementById('statConversion');

    // Mock data
    let visitsData = [120,150,180,140,210,230,200];
    let conversionsData = [12,20,15,18,30,28,22];
    let usersTotal = 124, sessionsTotal = 987;

    // Charts holders
    let visitsChart = null, convChart = null;
    let chartsInitialized = false;

    function updateStats(){
      statUsers.textContent = usersTotal;
      statSessions.textContent = sessionsTotal;
      const conv = Math.round((conversionsData.reduce((a,b)=>a+b,0) / Math.max(1, visitsData.reduce((a,b)=>a+b,0))) * 100);
      statConversion.textContent = (isFinite(conv) ? conv : 0) + '%';
    }

    // gradient helper
    function createGradient(ctx, top, bottom){
      const g = ctx.createLinearGradient(0,0,0,ctx.canvas.height);
      g.addColorStop(0, top); g.addColorStop(1, bottom);
      return g;
    }

    function createCharts(){
      if(!visitsCtxEl) return;
      // Visits chart
      const ctx1 = visitsCtxEl.getContext('2d');
      const fillG = createGradient(ctx1, 'rgba(0,224,255,0.12)', 'rgba(0,163,255,0.02)');
      if(visitsChart) visitsChart.destroy();
      visitsChart = new Chart(ctx1, {
        type:'line',
        data: {
          labels:['6d','5d','4d','3d','2d','1d','Hoje'],
          datasets:[{ label:'Visitas', data:visitsData, fill:true, backgroundColor:fillG, borderColor:'#00e0ff', tension:0.36, pointRadius:3, borderWidth:2 }]
        },
        options:{
          responsive:true, maintainAspectRatio:false,
          plugins:{legend:{display:false}},
          scales:{ x:{ ticks:{ color:'rgba(255,255,255,0.6)'}}, y:{ ticks:{ color:'rgba(255,255,255,0.5)'}} }
        }
      });

      // Conversions chart
      const ctx2 = convCtxEl.getContext('2d');
      if(convChart) convChart.destroy();
      convChart = new Chart(ctx2, {
        type:'bar',
        data:{
          labels:['6d','5d','4d','3d','2d','1d','Hoje'],
          datasets:[{ label:'Convers√µes', data:conversionsData, backgroundColor:'#00d2ff', borderRadius:6, barThickness:20 }]
        },
        options:{
          responsive:true, maintainAspectRatio:false,
          plugins:{legend:{display:false}},
          scales:{ x:{ ticks:{ color:'rgba(255,255,255,0.6)'}}, y:{ ticks:{ color:'rgba(255,255,255,0.5)'}} }
        }
      });

      chartsInitialized = true;
    }

    // UI list helpers
    function addListItem(el, text){
      const li = document.createElement('li');
      li.textContent = text;
      el.prepend(li);
    }

    function clearList(el){ el.innerHTML = ''; }

    // Initial population
    function populateInitial(){
      clearList(recentActions); ['Iniciado sistema','Item C','Item B','Item A'].forEach(t => addListItem(recentActions,t));
      clearList(todoList); ['Tarefa 2','Tarefa 1'].forEach(t => addListItem(todoList,t));
      clearList(usersList); ['Admin (Owner)'].forEach(t => addListItem(usersList,t));
      updateStats();
    }

    // Auto-refresh
    let autoInterval = null;
    autoRefresh?.addEventListener('change', function(){
      if(this.checked){
        autoInterval = setInterval(()=> {
          visitsData.push(Math.round(130 + Math.random()*120)); visitsData.shift();
          conversionsData.push(Math.round(8 + Math.random()*25)); conversionsData.shift();
          if(visitsChart){ visitsChart.data.datasets[0].data = visitsData; visitsChart.update(); }
          if(convChart){ convChart.data.datasets[0].data = conversionsData; convChart.update(); }
          sessionsTotal += Math.round(Math.random()*10); updateStats();
        }, 4500);
      } else { clearInterval(autoInterval); autoInterval = null; }
    });

    // Export CSV
    exportBtn?.addEventListener('click', ()=>{
      const rows = [['dia','visitas','conversoes'], ...visitsData.map((v,i)=>[i+1, v, conversionsData[i]||0])];
      const csv = rows.map(r => r.join(',')).join('\\n');
      const blob = new Blob([csv], {type:'text/csv'}); const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = 'revitarium-data.csv'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    });

    // Actions
    addActionBtn?.addEventListener('click', ()=> {
      const t = `A√ß√£o adicionada em ${new Date().toLocaleTimeString()}`;
      addListItem(recentActions, t);
    });
    clearActionsBtn?.addEventListener('click', ()=> clearList(recentActions));

    // Todos
    todoForm?.addEventListener('submit', (e)=> {
      e.preventDefault(); const v = (todoInput.value||'').trim(); if(!v) return; addListItem(todoList, v); todoInput.value='';
    });

    // Users add
    userForm?.addEventListener('submit', (e)=> {
      e.preventDefault(); const name = (document.getElementById('userName').value||'').trim(); const role = (document.getElementById('userRole').value||'').trim();
      if(!name) return; addListItem(usersList, `${name}${role? ' ('+role+')':''}`); usersTotal++; updateStats();
      document.getElementById('userName').value=''; document.getElementById('userRole').value='';
    });

    // NAV (sidebar) optional behavior
    document.querySelectorAll('.icon-btn').forEach(b => b.addEventListener('click', ()=> {
      document.querySelectorAll('.icon-btn').forEach(x=>x.classList.remove('active')); b.classList.add('active');
    }));

    // LOGOUT
    btnLogout?.addEventListener('click', ()=> {
      localStorage.removeItem('rev_user');
      showLogin();
    });

    // ===== LOGIN handling =====
    function showDashboard(){
      loginView.classList.add('hidden'); loginView.setAttribute('aria-hidden','true');
      dashboardView.classList.remove('hidden'); dashboardView.setAttribute('aria-hidden','false');
      populateInitial();
      if(!chartsInitialized) createCharts();
      updateStats();
    }
    function showLogin(){
      dashboardView.classList.add('hidden'); dashboardView.setAttribute('aria-hidden','true');
      loginView.classList.remove('hidden'); loginView.setAttribute('aria-hidden','false');
    }

    // If already logged, show dashboard
    if(localStorage.getItem('rev_user') === 'ok'){
      showDashboard();
    } else {
      showLogin();
    }

    // Login form submission
    loginForm?.addEventListener('submit', (e)=>{
      e.preventDefault();
      const user = (userInput.value||'').trim();
      const pass = (passInput.value||'').trim();
      if(!user || !pass){ alert('Preencha todos os campos!'); return; }

      // simple mock auth: admin/123
      if(user === 'admin' && pass === '123'){
        localStorage.setItem('rev_user','ok');
        // small delay to feel responsive
        setTimeout(()=> showDashboard(), 180);
        userInput.value=''; passInput.value='';
      } else {
        alert('Usu√°rio ou senha incorretos!');
      }
    });

    // Accessibility: ctrl/cmd+e export
    document.addEventListener('keydown', function(e){
      if((e.ctrlKey || e.metaKey) && e.key === 'e') exportBtn?.click();
    });

    // Ensure charts re-draw on resize (maintain gradients)
    window.addEventListener('resize', ()=> { if(chartsInitialized) createCharts(); });

  })();
  </script>
</body>
</html>
